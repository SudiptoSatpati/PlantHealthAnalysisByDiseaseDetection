# Coffee Leaf Analyzer

A Streamlit web application that analyzes images of coffee leaves to:

- Verify if the uploaded image is a leaf or not
- Detect coffee leaf diseases (healthy, rust, phoma)
- Identify nutrient deficiencies
- Provide expert remedies and solutions using Google Gemini API

---

## 🚀 Features

- **Leaf Verification**: Ensures only leaf images are processed.
- **Disease Detection**: Classifies into `Healthy`, `Rust Leaves`, or `Phoma`.
- **Nutrient Deficiency**: Predicts common deficiencies (e.g., Nitrogen, Phosphorus).
- **Remedies & Solutions**: Leverages Google Gemini to generate actionable tips.
- **Modern UI**: Clean design with cards, sidebar instructions, and themed colors.

---

## 📁 Project Structure

```
coffee_leaf_app/
│
├── .streamlit/
│   └── config.toml           # Theme configuration
├── app.py                    # Main Streamlit application
├── README.md                 # Project documentation
├── requirements.txt          # Python dependencies
├── utils/
│   ├── preprocessing.py      # Image preprocessing functions
│   ├── prediction.py         # Model loading & prediction logic
│   └── gemini.py             # Google Gemini API integration
└── models/
    ├── leaf_classifier.pkl   # SVM model for leaf detection
    ├── coffee_disease_model.pkl  # SVM model for disease classification
    └── trainer_nutrition_model.keras # TensorFlow model for deficiency detection
```

---

## 🛠️ Installation

1. **Clone the repository**:

   ```bash
   git clone https://github.com/yourusername/coffee_leaf_analyzer.git
   cd coffee_leaf_app
   ```

2. **Create & activate a virtual environment** (optional but recommended):

   ```bash
   python3 -m venv venv
   source venv/bin/activate   # macOS/Linux
   venv\Scripts\activate    # Windows
   ```

3. **Install dependencies**:

   ```bash
   pip install -r requirements.txt
   ```

4. **Set up environment variables**:

   - Create a `.env` file in the project root with:

     ```env
     GEMINI_API_KEY=your_google_gemini_api_key
     ```

   - Ensure `python-dotenv` is installed to load these variables.

---

## ⚙️ Usage

Run the Streamlit app:

```bash
streamlit run app.py
```

1. Open the provided local URL in your browser.
2. Upload a photo of a coffee leaf.
3. View leaf verification, disease & deficiency results.
4. Read expert remedies and solutions generated by Gemini.

---

## 📦 Models

- **leaf_classifier.pkl**: SVM model (Canny edges) to filter non-leaf images.
- **coffee_disease_model.pkl**: SVM model combining HSV histograms & edges for disease detection.
- **trainer_nutrition_model.keras**: CNN model trained on 128×128 images for nutrient deficiency classification.

---

## 🔧 Customization

- **Theme**: Modify colors in `.streamlit/config.toml`.
- **Labels**: Update label dictionaries in `utils/prediction.py` for custom classes.
- **Gemini Prompts**: Tweak prompt templates in `utils/gemini.py`.

---

## 🤝 Contributing

Contributions are welcome! Please open an issue or submit a pull request.

---

## 📄 License

This project is MIT licensed. See [LICENSE](LICENSE) for details.
